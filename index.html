<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Management System</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            background-color: #2c3e50;
            color: white;
            padding: 1rem;
            text-align: center;
            margin-bottom: 20px;
        }
        h1 {
            margin: 0;
        }
        .dashboard {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
        }
        .card {
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            padding: 20px;
            flex: 1;
            min-width: 250px;
            text-align: center;
        }
        .card h3 {
            margin-top: 0;
            color: #2c3e50;
        }
        .card .number {
            font-size: 2rem;
            font-weight: bold;
            color: #3498db;
        }
        .form-section {
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            padding: 20px;
            margin-bottom: 20px;
        }
        .form-row {
            display: flex;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 15px;
        }
        .form-group {
            flex: 1;
            min-width: 200px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, select, textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }
        button:hover {
            background-color: #2980b9;
        }
        .action-button {
            margin-right: 5px;
            padding: 5px 10px;
        }
        .edit {
            background-color: #f39c12;
        }
        .delete {
            background-color: #e74c3c;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
            color: #2c3e50;
        }
        tr:hover {
            background-color: #f5f5f5;
        }
        .alert {
            padding: 10px;
            background-color: #d4edda;
            color: #155724;
            border-radius: 4px;
            margin-bottom: 15px;
            display: none;
        }
        .tab-container {
            margin-bottom: 20px;
        }
        .tabs {
            display: flex;
            list-style: none;
            padding: 0;
            margin: 0;
            border-bottom: 1px solid #ddd;
        }
        .tabs li {
            padding: 10px 20px;
            cursor: pointer;
            background-color: #f2f2f2;
            border: 1px solid #ddd;
            border-bottom: none;
            border-radius: 5px 5px 0 0;
            margin-right: 5px;
        }
        .tabs li.active {
            background-color: white;
            border-bottom: 1px solid white;
            margin-bottom: -1px;
            font-weight: bold;
        }
        .tab-content {
            background-color: white;
            padding: 20px;
            border: 1px solid #ddd;
            border-top: none;
            border-radius: 0 0 5px 5px;
        }
        .tab-pane {
            display: none;
        }
        .tab-pane.active {
            display: block;
        }
        .search-container {
            margin-bottom: 20px;
        }
        #searchInput {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .import-export {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .stock-warning {
            color: #e74c3c;
            font-weight: bold;
        }
        .category-filter {
            margin-bottom: 20px;
        }
        .pagination {
            display: flex;
            justify-content: center;
            margin-top: 20px;
        }
        .pagination button {
            margin: 0 5px;
        }
    </style>
</head>
<body>
    <header>
        <h1>Product Management System</h1>
    </header>

    <div class="container">
        <div class="alert" id="alert">Operation completed successfully!</div>

        <div class="dashboard">
            <div class="card">
                <h3>Total Products</h3>
                <div class="number" id="totalProducts">0</div>
            </div>
            <div class="card">
                <h3>Categories</h3>
                <div class="number" id="totalCategories">0</div>
            </div>
            <div class="card">
                <h3>Low Stock</h3>
                <div class="number" id="lowStockCount">0</div>
            </div>
            <div class="card">
                <h3>Total Value</h3>
                <div class="number" id="totalValue">$0.00</div>
            </div>
        </div>

        <div class="tab-container">
            <ul class="tabs">
                <li class="active" data-tab="products">Products</li>
                <li data-tab="add-product">Add Product</li>
                <li data-tab="categories">Categories</li>
                <li data-tab="reports">Reports</li>
                <li data-tab="settings">Settings</li>
            </ul>

            <div class="tab-content">
                <!-- Products Tab -->
                <div class="tab-pane active" id="products">
                    <div class="search-container">
                        <input type="text" id="searchInput" placeholder="Search products...">
                    </div>
                    
                    <div class="category-filter">
                        <label for="categoryFilter">Filter by Category:</label>
                        <select id="categoryFilter">
                            <option value="">All Categories</option>
                        </select>
                    </div>
                    
                    <div class="import-export">
                        <button id="importBtn">Import Data</button>
                        <button id="exportBtn">Export Data</button>
                    </div>
                    
                    <table id="productsTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Category</th>
                                <th>Price</th>
                                <th>Stock</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Product rows will be added here dynamically -->
                        </tbody>
                    </table>
                    
                    <div class="pagination">
                        <button id="prevPage">Previous</button>
                        <span id="pageInfo">Page 1 of 1</span>
                        <button id="nextPage">Next</button>
                    </div>
                </div>

                <!-- Add Product Tab -->
                <div class="tab-pane" id="add-product">
                    <div class="form-section">
                        <h2>Add New Product</h2>
                        <form id="addProductForm">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="productName">Product Name:</label>
                                    <input type="text" id="productName" required>
                                </div>
                                <div class="form-group">
                                    <label for="productCategory">Category:</label>
                                    <select id="productCategory" required>
                                        <option value="">Select Category</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="productPrice">Price ($):</label>
                                    <input type="number" id="productPrice" step="0.01" min="0" required>
                                </div>
                                <div class="form-group">
                                    <label for="productCost">Cost ($):</label>
                                    <input type="number" id="productCost" step="0.01" min="0" required>
                                </div>
                                <div class="form-group">
                                    <label for="productStock">Stock Quantity:</label>
                                    <input type="number" id="productStock" min="0" required>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="productSKU">SKU:</label>
                                    <input type="text" id="productSKU">
                                </div>
                                <div class="form-group">
                                    <label for="productStatus">Status:</label>
                                    <select id="productStatus" required>
                                        <option value="active">Active</option>
                                        <option value="inactive">Inactive</option>
                                        <option value="out-of-stock">Out of Stock</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="productDescription">Description:</label>
                                    <textarea id="productDescription" rows="4"></textarea>
                                </div>
                            </div>
                            
                            <button type="submit">Add Product</button>
                        </form>
                    </div>
                </div>

                <!-- Categories Tab -->
                <div class="tab-pane" id="categories">
                    <div class="form-section">
                        <h2>Add New Category</h2>
                        <form id="addCategoryForm">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="categoryName">Category Name:</label>
                                    <input type="text" id="categoryName" required>
                                </div>
                                <div class="form-group">
                                    <label for="categoryDescription">Description:</label>
                                    <input type="text" id="categoryDescription">
                                </div>
                            </div>
                            <button type="submit">Add Category</button>
                        </form>
                    </div>
                    
                    <h2>Categories</h2>
                    <table id="categoriesTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Description</th>
                                <th>Product Count</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Category rows will be added here dynamically -->
                        </tbody>
                    </table>
                </div>

                <!-- Reports Tab -->
                <div class="tab-pane" id="reports">
                    <h2>Product Reports</h2>
                    
                    <div class="form-section">
                        <h3>Stock Level Report</h3>
                        <div id="stockLevelChart">
                            <!-- Chart will be rendered here -->
                            <p>Chart showing product stock levels will be displayed here</p>
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <h3>Low Stock Products</h3>
                        <table id="lowStockTable">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Name</th>
                                    <th>Category</th>
                                    <th>Current Stock</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Low stock product rows will be added here dynamically -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="form-section">
                        <h3>Inventory Value by Category</h3>
                        <div id="categoryValueChart">
                            <!-- Chart will be rendered here -->
                            <p>Chart showing inventory value by category will be displayed here</p>
                        </div>
                    </div>
                </div>
                
                <!-- Settings Tab -->
                <div class="tab-pane" id="settings">
                    <h2>System Settings</h2>
                    
                    <div class="form-section">
                        <h3>Data Management</h3>
                        <p>Here you can manage your application data. Be careful with these options as some actions cannot be undone.</p>
                        
                        <div style="margin-top: 20px;">
                            <button id="clearDataBtn" style="background-color: #e74c3c;">Clear All Data</button>
                            <p style="margin-top: 5px; font-size: 0.9em; color: #777;">This will delete all products and categories. This action cannot be undone.</p>
                        </div>
                        
                        <div style="margin-top: 20px;">
                            <button id="resetToSampleBtn">Reset to Sample Data</button>
                            <p style="margin-top: 5px; font-size: 0.9em; color: #777;">This will replace all current data with the default sample data.</p>
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <h3>About</h3>
                        <p>Product Management System v1.0</p>
                        <p>This application uses localStorage to save your data in your browser.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Product Modal (Hidden by default) -->
    <div id="editProductModal" style="display: none; position: fixed; z-index: 1; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.4);">
        <div style="background-color: white; margin: 15% auto; padding: 20px; border: 1px solid #888; width: 80%; max-width: 700px; border-radius: 5px;">
            <span style="color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer;" id="closeModal">&times;</span>
            <h2>Edit Product</h2>
            <form id="editProductForm">
                <input type="hidden" id="editProductId">
                <div class="form-row">
                    <div class="form-group">
                        <label for="editProductName">Product Name:</label>
                        <input type="text" id="editProductName" required>
                    </div>
                    <div class="form-group">
                        <label for="editProductCategory">Category:</label>
                        <select id="editProductCategory" required>
                            <option value="">Select Category</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="editProductPrice">Price ($):</label>
                        <input type="number" id="editProductPrice" step="0.01" min="0" required>
                    </div>
                    <div class="form-group">
                        <label for="editProductCost">Cost ($):</label>
                        <input type="number" id="editProductCost" step="0.01" min="0" required>
                    </div>
                    <div class="form-group">
                        <label for="editProductStock">Stock Quantity:</label>
                        <input type="number" id="editProductStock" min="0" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="editProductSKU">SKU:</label>
                        <input type="text" id="editProductSKU">
                    </div>
                    <div class="form-group">
                        <label for="editProductStatus">Status:</label>
                        <select id="editProductStatus" required>
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                            <option value="out-of-stock">Out of Stock</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="editProductDescription">Description:</label>
                        <textarea id="editProductDescription" rows="4"></textarea>
                    </div>
                </div>
                
                <button type="submit">Update Product</button>
            </form>
        </div>
    </div>

    <script>
        // Store for our data
        const appData = {
            products: [],
            categories: [],
            currentPage: 1,
            itemsPerPage: 10,
            selectedCategory: "",
            searchTerm: ""
        };

        // DOM ready
        document.addEventListener('DOMContentLoaded', function() {
            // Load data from localStorage if available, otherwise load sample data
            loadData();
            
            // Initialize UI
            updateDashboard();
            populateCategoryDropdowns();
            displayProducts();
            displayCategories();
            displayLowStockProducts();
            
            // Add event listeners
            setupEventListeners();
        });

        function loadData() {
            // Try to load from localStorage first
            const savedProducts = localStorage.getItem('productManagementProducts');
            const savedCategories = localStorage.getItem('productManagementCategories');
            
            if (savedProducts && savedCategories) {
                // Parse the saved data
                appData.products = JSON.parse(savedProducts);
                appData.categories = JSON.parse(savedCategories);
                showAlert('Data loaded from local storage', 'success');
            } else {
                // Load sample data if no saved data exists
                loadSampleData();
                showAlert('Sample data loaded', 'info');
                // Save the sample data for next time
                saveData();
            }
        }

        function loadSampleData() {
            // Sample categories
            appData.categories = [
                { id: 1, name: "Electronics", description: "Electronic devices and gadgets", productCount: 3 },
                { id: 2, name: "Clothing", description: "Apparel and accessories", productCount: 2 },
                { id: 3, name: "Home & Kitchen", description: "Items for home and kitchen use", productCount: 1 }
            ];

            // Sample products
            appData.products = [
                { id: 1, name: "Laptop", category: "Electronics", categoryId: 1, price: 899.99, cost: 650, stock: 15, sku: "ELEC-001", status: "active", description: "15-inch laptop with 8GB RAM" },
                { id: 2, name: "Smartphone", category: "Electronics", categoryId: 1, price: 499.99, cost: 320, stock: 25, sku: "ELEC-002", status: "active", description: "Latest model smartphone" },
                { id: 3, name: "Headphones", category: "Electronics", categoryId: 1, price: 89.99, cost: 45, stock: 3, sku: "ELEC-003", status: "active", description: "Wireless over-ear headphones" },
                { id: 4, name: "T-shirt", category: "Clothing", categoryId: 2, price: 19.99, cost: 8, stock: 50, sku: "CLO-001", status: "active", description: "Cotton t-shirt, various colors" },
                { id: 5, name: "Jeans", category: "Clothing", categoryId: 2, price: 49.99, cost: 22, stock: 30, sku: "CLO-002", status: "active", description: "Denim jeans, slim fit" },
                { id: 6, name: "Coffee Maker", category: "Home & Kitchen", categoryId: 3, price: 79.99, cost: 42, stock: 10, sku: "HOME-001", status: "active", description: "Drip coffee maker, 12-cup capacity" }
            ];
        }

        function setupEventListeners() {
            // Tab switching
            document.querySelectorAll('.tabs li').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    switchTab(tabId);
                });
            });
            
            // Add product form submission
            document.getElementById('addProductForm').addEventListener('submit', function(e) {
                e.preventDefault();
                addProduct();
            });
            
            // Add category form submission
            document.getElementById('addCategoryForm').addEventListener('submit', function(e) {
                e.preventDefault();
                addCategory();
            });
            
            // Edit product form submission
            document.getElementById('editProductForm').addEventListener('submit', function(e) {
                e.preventDefault();
                updateProduct();
            });
            
            // Close modal button
            document.getElementById('closeModal').addEventListener('click', function() {
                document.getElementById('editProductModal').style.display = 'none';
            });
            
            // Search input
            document.getElementById('searchInput').addEventListener('input', function() {
                appData.searchTerm = this.value;
                appData.currentPage = 1;
                displayProducts();
            });
            
            // Category filter
            document.getElementById('categoryFilter').addEventListener('change', function() {
                appData.selectedCategory = this.value;
                appData.currentPage = 1;
                displayProducts();
            });
            
            // Pagination buttons
            document.getElementById('prevPage').addEventListener('click', function() {
                if (appData.currentPage > 1) {
                    appData.currentPage--;
                    displayProducts();
                }
            });
            
            document.getElementById('nextPage').addEventListener('click', function() {
                const filteredProducts = getFilteredProducts();
                const totalPages = Math.ceil(filteredProducts.length / appData.itemsPerPage);
                if (appData.currentPage < totalPages) {
                    appData.currentPage++;
                    displayProducts();
                }
            });
            
            // Import/Export buttons
            document.getElementById('importBtn').addEventListener('click', importData);
            document.getElementById('exportBtn').addEventListener('click', exportData);
        }

        function switchTab(tabId) {
            // Remove active class from all tabs and panes
            document.querySelectorAll('.tabs li').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-pane').forEach(pane => {
                pane.classList.remove('active');
            });
            
            // Add active class to selected tab and pane
            document.querySelector(`.tabs li[data-tab="${tabId}"]`).classList.add('active');
            document.getElementById(tabId).classList.add('active');
        }

        function populateCategoryDropdowns() {
            const categorySelects = [
                document.getElementById('productCategory'),
                document.getElementById('editProductCategory'),
                document.getElementById('categoryFilter')
            ];
            
            categorySelects.forEach(select => {
                // Clear existing options (except for the first one in case of categoryFilter)
                const firstOption = select.options[0];
                select.innerHTML = '';
                if (firstOption && firstOption.value === '') {
                    select.appendChild(firstOption);
                }
                
                // Add category options
                appData.categories.forEach(category => {
                    const option = document.createElement('option');
                    option.value = category.id;
                    option.textContent = category.name;
                    select.appendChild(option);
                });
            });
        }

        function getFilteredProducts() {
            return appData.products.filter(product => {
                const matchesSearch = product.name.toLowerCase().includes(appData.searchTerm.toLowerCase()) ||
                                    product.sku.toLowerCase().includes(appData.searchTerm.toLowerCase());
                const matchesCategory = appData.selectedCategory === "" || product.categoryId == appData.selectedCategory;
                return matchesSearch && matchesCategory;
            });
        }

        function displayProducts() {
            const tableBody = document.querySelector('#productsTable tbody');
            tableBody.innerHTML = '';
            
            const filteredProducts = getFilteredProducts();
            
            // Calculate pagination
            const startIndex = (appData.currentPage - 1) * appData.itemsPerPage;
            const endIndex = Math.min(startIndex + appData.itemsPerPage, filteredProducts.length);
            const displayedProducts = filteredProducts.slice(startIndex, endIndex);
            
            // Update page info
            const totalPages = Math.ceil(filteredProducts.length / appData.itemsPerPage);
            document.getElementById('pageInfo').textContent = `Page ${appData.currentPage} of ${totalPages || 1}`;
            
            // Display products
            if (displayedProducts.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = '<td colspan="7" style="text-align: center;">No products found</td>';
                tableBody.appendChild(row);
            } else {
                displayedProducts.forEach(product => {
                    const row = document.createElement('tr');
                    
                    const statusClass = product.stock <= 5 ? 'stock-warning' : '';
                    
                    row.innerHTML = `
                        <td>${product.id}</td>
                        <td>${product.name}</td>
                        <td>${product.category}</td>
                        <td>$${product.price.toFixed(2)}</td>
                        <td class="${statusClass}">${product.stock}</td>
                        <td>${product.status}</td>
                        <td>
                            <button class="action-button edit" data-id="${product.id}">Edit</button>
                            <button class="action-button delete" data-id="${product.id}">Delete</button>
                        </td>
                    `;
                    
                    tableBody.appendChild(row);
                });
                
                // Add event listeners to edit/delete buttons
                document.querySelectorAll('.edit').forEach(button => {
                    button.addEventListener('click', function() {
                        const productId = this.getAttribute('data-id');
                        openEditModal(productId);
                    });
                });
                
                document.querySelectorAll('.delete').forEach(button => {
                    button.addEventListener('click', function() {
                        const productId = this.getAttribute('data-id');
                        deleteProduct(productId);
                    });
                });
            }
        }

        function displayCategories() {
            const tableBody = document.querySelector('#categoriesTable tbody');
            tableBody.innerHTML = '';
            
            if (appData.categories.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = '<td colspan="5" style="text-align: center;">No categories found</td>';
                tableBody.appendChild(row);
            } else {
                appData.categories.forEach(category => {
                    const row = document.createElement('tr');
                    
                    row.innerHTML = `
                        <td>${category.id}</td>
                        <td>${category.name}</td>
                        <td>${category.description}</td>
                        <td>${category.productCount}</td>
                        <td>
                            <button class="action-button edit-category" data-id="${category.id}">Edit</button>
                            <button class="action-button delete-category" data-id="${category.id}">Delete</button>
                        </td>
                    `;
                    
                    tableBody.appendChild(row);
                });
                
                // Add event listeners to edit/delete buttons
                document.querySelectorAll('.edit-category').forEach(button => {
                    button.addEventListener('click', function() {
                        const categoryId = this.getAttribute('data-id');
                        // TODO: Implement edit category functionality
                        alert('Edit category functionality will be implemented here');
                    });
                });
                
                document.querySelectorAll('.delete-category').forEach(button => {
                    button.addEventListener('click', function() {
                        const categoryId = this.getAttribute('data-id');
                        deleteCategory(categoryId);
                    });
                });
            }
        }

        function displayLowStockProducts() {
            const tableBody = document.querySelector('#lowStockTable tbody');
            tableBody.innerHTML = '';
            
            const lowStockProducts = appData.products.filter(product => product.stock <= 5);
            
            if (lowStockProducts.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = '<td colspan="5" style="text-align: center;">No low stock products found</td>';
                tableBody.appendChild(row);
            } else {
                lowStockProducts.forEach(product => {
                    const row = document.createElement('tr');
                    
                    row.innerHTML = `
                        <td>${product.id}</td>
                        <td>${product.name}</td>
                        <td>${product.category}</td>
                        <td class="stock-warning">${product.stock}</td>
                        <td>
                            <button class="action-button" onclick="restockProduct(${product.id})">Restock</button>
                        </td>
                    `;
                    
                    tableBody.appendChild(row);
                });
            }
        }

        function updateDashboard() {
            document.getElementById('totalProducts').textContent = appData.products.length;
            document.getElementById('totalCategories').textContent = appData.categories.length;
            
            const lowStockProducts = appData.products.filter(product => product.stock <= 5);
            document.getElementById('lowStockCount').textContent = lowStockProducts.length;
            
            const totalValue = appData.products.reduce((sum, product) => sum + (product.price * product.stock), 0);
            document.getElementById('totalValue').textContent = '$' + totalValue.toFixed(2);
        }

        function saveData() {
            // Save to localStorage
            localStorage.setItem('productManagementProducts', JSON.stringify(appData.products));
            localStorage.setItem('productManagementCategories', JSON.stringify(appData.categories));
        }

        function addProduct() {
            const form = document.getElementById('addProductForm');
            
            const categoryId = parseInt(document.getElementById('productCategory').value);
            const category = appData.categories.find(c => c.id === categoryId);
            
            if (!category) {
                showAlert('Please select a valid category');
                return;
            }
            
            const newProduct = {
                id: appData.products.length > 0 ? Math.max(...appData.products.map(p => p.id)) + 1 : 1,
                name: document.getElementById('productName').value,
                category: category.name,
                categoryId: categoryId,
                price: parseFloat(document.getElementById('productPrice').value),
                cost: parseFloat(document.getElementById('productCost').value),
                stock: parseInt(document.getElementById('productStock').value),
                sku: document.getElementById('productSKU').value,
                status: document.getElementById('productStatus').value,
                description: document.getElementById('productDescription').value
            };
            
            appData.products.push(newProduct);
            
            // Update category product count
            category.productCount++;
            
            // Update UI
            updateDashboard();
            displayProducts();
            displayLowStockProducts();
            
            // Save data
            saveData();
            
            // Reset form
            form.reset();
            
            // Show success message
            showAlert('Product added successfully');
        }

        function addCategory() {
            const form = document.getElementById('addCategoryForm');
            
            const newCategory = {
                id: appData.categories.length > 0 ? Math.max(...appData.categories.map(c => c.id)) + 1 : 1,
                name: document.getElementById('categoryName').value,
                description: document.getElementById('categoryDescription').value,
                productCount: 0
            };
            
            appData.categories.push(newCategory);
            
            // Update UI
            updateDashboard();
            displayCategories();
            populateCategoryDropdowns();
            
            // Save data
            saveData();
            
            // Reset form
            form.reset();
            
            // Show success message
            showAlert('Category added successfully');
        }

        function openEditModal(productId) {
            const product = appData.products.find(p => p.id == productId);
            
            if (!product) return;
            
            // Fill form fields
            document.getElementById('editProductId').value = product.id;
            document.getElementById('editProductName').value = product.name;
            document.getElementById('editProductCategory').value = product.categoryId;
            document.getElementById('editProductPrice').value = product.price;
            document.getElementById('editProductCost').value = product.cost;
            document.getElementById('editProductStock').value = product.stock;
            document.getElementById('editProductSKU').value = product.sku;
            document.getElementById('editProductStatus').value = product.status;
            document.getElementById('editProductDescription').value = product.description;
            
            // Show modal
            document.getElementById('editProductModal').style.display = 'block';
        }

        function updateProduct() {
            const productId = parseInt(document.getElementById('editProductId').value);
            const product = appData.products.find(p => p.id === productId);
            
            if (!product) return;
            
            const newCategoryId = parseInt(document.getElementById('editProductCategory').value);
            const newCategory = appData.categories.find(c => c.id === newCategoryId);
            
            if (!newCategory) {
                showAlert('Please select a valid category');
                return;
            }
            
            const oldCategoryId = product.categoryId;
            
            // Update product data
            product.name = document.getElementById('editProductName').value;
            product.category = newCategory.name;
            product.categoryId = newCategoryId;
            product.price = parseFloat(document.getElementById('editProductPrice').value);
            product.cost = parseFloat(document.getElementById('editProductCost').value);
            product.stock = parseInt(document.getElementById('editProductStock').value);
            product.sku = document.getElementById('editProductSKU').value;
            product.status = document.getElementById('editProductStatus').value;
            product.description = document.getElementById('editProductDescription').value;
            
            // Update category product counts if category changed
            if (oldCategoryId !== newCategoryId) {
                const oldCategory = appData.categories.find(c => c.id === oldCategoryId);
                if (oldCategory) oldCategory.productCount--;
                newCategory.productCount++;
            }
            
            // Update UI
            updateDashboard();
            displayProducts();
            displayLowStockProducts();
            
            // Save data
            saveData();
            
            // Hide modal
            document.getElementById('editProductModal').style.display = 'none';
            
            // Show success message
            showAlert('Product updated successfully');
        }

        function deleteProduct(productId) {
            if (!confirm('Are you sure you want to delete this product?')) return;
            
            const productIndex = appData.products.findIndex(p => p.id == productId);
            
            if (productIndex === -1) return;
            
            const product = appData.products[productIndex];
            
            // Update category product count
            const category = appData.categories.find(c => c.id === product.categoryId);
            if (category) category.productCount--;
            
            // Remove product
            appData.products.splice(productIndex, 1);
            
            // Update UI
            updateDashboard();
            displayProducts();
            displayLowStockProducts();
            
            // Save data
            saveData();
            
            // Show success message
            showAlert('Product deleted successfully');
        }

        function deleteCategory(categoryId) {
            const category = appData.categories.find(c => c.id == categoryId);
            
            if (!category) return;
            
            // Check if category has products
            if (category.productCount > 0) {
                alert(`Cannot delete category "${category.name}" because it contains products. Please move or delete the products first.`);
                return;
            }
            
            if (!confirm(`Are you sure you want to delete the category "${category.name}"?`)) return;
            
            const categoryIndex = appData.categories.findIndex(c => c.id == categoryId);
            appData.categories.splice(categoryIndex, 1);
            
            // Update UI
            updateDashboard();
            displayCategories();
            populateCategoryDropdowns();
            
            // Save data
            saveData();
            
            // Show success message
            showAlert('Category deleted successfully');
        }

        function showAlert(message, type = 'success') {
            const alert = document.getElementById('alert');
            alert.textContent = message;
            alert.style.display = 'block';
            
            // Set alert style based on type
            if (type === 'success') {
                alert.style.backgroundColor = '#d4edda';
                alert.style.color = '#155724';
            } else if (type === 'error') {
                alert.style.backgroundColor = '#f8d7da';
                alert.style.color = '#721c24';
            } else if (type === 'info') {
                alert.style.backgroundColor = '#d1ecf1';
                alert.style.color = '#0c5460';
            }
            
            setTimeout(() => {
                alert.style.display = 'none';
            }, 3000);
        }

        function importData() {
            // In a real application, this would open a file dialog
            alert('This function would allow importing product data from CSV/Excel files');
            
            // For demo purposes, we'll just add a sample imported product
            const newProduct = {
                id: appData.products.length > 0 ? Math.max(...appData.products.map(p => p.id)) + 1 : 1,
                name: "Imported Product",
                category: "Electronics",
                categoryId: 1,
                price: 129.99,
                cost: 80,
                stock: 12,
                sku: "IMP-001",
                status: "active",
                description: "This is an imported product"
            };
            
            appData.products.push(newProduct);
            
            // Update category product count
            const category = appData.categories.find(c => c.id === 1);
            if (category) category.productCount++;
            
            // Update UI
            updateDashboard();
            displayProducts();
            displayLowStockProducts();
            
            // Save data
            saveData();
            
            // Show success message
            showAlert('Sample product imported successfully');
        }

        function exportData() {
            // In a real application, this would generate and download a CSV/Excel file
            alert('This function would export your product data to CSV/Excel');
            
            // For demo purposes, we'll just show what would be exported
            console.log('Products to export:', appData.products);
            
            showAlert('Export function triggered (check console for exported data)');
        }

        function restockProduct(productId) {
            const product = appData.products.find(p => p.id == productId);
            
            if (!product) return;
            
            const quantity = parseInt(prompt(`Enter restock quantity for ${product.name}:`, "10"));
            
            if (isNaN(quantity) || quantity <= 0) {
                alert('Please enter a valid quantity');
                return;
            }
            
            product.stock += quantity;
            
            // Update UI
            updateDashboard();
            displayProducts();
            displayLowStockProducts();
            
            // Save data
            saveData();
            
            // Show success message
            showAlert(`Restocked ${product.name} with ${quantity} units`);
        }
        
        function clearAllData() {
            if (confirm('Are you sure you want to clear all data? This action cannot be undone.')) {
                // Clear data from localStorage
                localStorage.removeItem('productManagementProducts');
                localStorage.removeItem('productManagementCategories');
                
                // Reset application data
                appData.products = [];
                appData.categories = [];
                
                // Update UI
                updateDashboard();
                displayProducts();
                displayCategories();
                displayLowStockProducts();
                populateCategoryDropdowns();
                
                showAlert('All data has been cleared');
            }
        }
    </script>
</body>
</html>
